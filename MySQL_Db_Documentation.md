# Welcome to Miksi

## Introduction
Welcome to **Miksi**. At Miksi, we utilize state-of-the-art AI to revolutionize Business Intelligence. We offer you the next generation of conversational BI tools, bringing your data to life and making insights more accessible than ever, without having to expose any of you or your customer data to us.

## Miksi Agent
The Miksi Agent is a powerful tool designed to connect seamlessly with your SQL databases. It's part of the broader Miksi AI ecosystem, crafted to enhance your experience with business intelligence.

### Important Information
Our agent interacts with your database by executing queries within **sandboxed environments**. While it's highly tuned not to execute queries that modify the database, we highly recommend that you do not run against the main production database and provide user accounts with no rights to modify the database. 

This is a Python documentation for the SQL agent.

## Process
1. **Create a Virtual Environment:**
   - `python -m venv venv`
   - or `python3 -m venv venv`
2. **Activate the Virtual Environment:**
Activate the virtual environment by running:
   - Windows: 
   `source venv/Scripts/activate`
   - On Linux/Mac:
   `source venv/bin/activate`

3. **Generate API Key:**

   - Visit [MiksiAPI](https://miksiapi-miksi.pythonanywhere.com), sign up or log in, then generate your API key.This API key will be used to use the Miksi SDK.

4. **Install Miksi SDK:**
   - Install the latest version: `pip install miksisdk`

## Using the Package
To connect to your database, you can import and use the **DatabaseConnector:**

```python
from miksisdk.base import DatabaseConnector
```

# Connect to your database
Create a new instance or object and provide host, user, database name, and password, 

```python
connector = DatabaseConnector(db_user=db_user, db_password=db_password,
                              db_host=db_host, db_name=db_name)
```
You can check the status of your connection by;

```python
status = connector.connect()
```
Create a new instance of the database
```python
# Get a new DB instance
db = connector.getdbinstance()
```
### Example function to get DB

```python
def get_db():
    connector = DatabaseConnector(db_user=db_user, db_password=db_password,
                                  db_host=db_host, db_name=db_name)
    db = connector.getdbinstance()
    return db

db = get_db() 

```
The DB instance must be assigned to a global variable named **'db'**


```python
# Sample DB Connection Function
def get_db():
    connector = DatabaseConnector(db_user=db_user, db_password=db_password, 
                                  db_host=db_host, db_name=db_name)
    db = connector.getdbinstance()
    return db

db = get_db()

```
#### Note: The DB instance should be assigned to a global variable named 'db', as it's required by the agent.

# Defining a Large Language Model (LLM)
The LLM is already configured for you, you just need to create a new instance of the default llm,pass miksi_api_key, and assign it to a global variable  

```python
miksi_api_key = 'your miksi api key'
 ```
Get your key at [MiksiAPI](https://miksiapi-miksi.pythonanywhere.com)

```python
from miksisdk.api import MiksiAPIHandler

model = MiksiAPIHandler(miksi_api_key=miksi_api_key)
llm = model.get_default_llm(miksi_api_key=miksi_api_key)
```

# Creating the Agent
The agent is responsible for processing your queries related to the database and giving you back the response
You can create the agent by importing Agentinitializer from miksisdk.
Provide llm and db variables from above as arguements

# Setting Up the Agent

```python
### Import AgentInitializer:
from miksisdk.agent import AgentInitializer

# Instantiate the AgentInitializer:
agent_initializer = AgentInitializer(llm, db)
```

# Charts and graphs

If there are graphs/ charts generated by default they are saved inside the base directory inside a folder called images.

# Custom Media Path

Optionally, you can specify a path for image/chart storage:

```python
path = 'your path here'
agent_initializer = AgentInitializer(llm, db, path)
```


# Create the agent:
create the agent instance by calling the create_agent method of AgentInitializer

```python
agent = agent_initializer.create_agent()
```


# Running Queries
To pass a question  to the agent and get the response, call the run method from the created agent. 


### Execute a query and get the response:
```python
query = "make a chart about our top10 best-selling markets."
response = agent.run(query)
```
